---
import type { GetStaticPaths } from "astro";
import { getCollection, type CollectionEntry } from "astro:content";
import LayoutNav from "../../layouts/Layout-nav.astro";

export const prerender = true;

export const getStaticPaths: GetStaticPaths = async () => {
  const posts = await getCollection("blog");

  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
};

const { post } = Astro.props as { post: CollectionEntry<"blog"> };

const { Content } = await post.render();

// Formato fecha
const formatDate = (date: string | Date) =>
  new Intl.DateTimeFormat("es-ES", {
    day: "2-digit",
    month: "long",
    year: "numeric",
  }).format(new Date(date));
---

<LayoutNav
  title={post.data.title}
  description={post.data.description ||
    `Lee el artÃ­culo ${post.data.title} en el blog de Nils Pineda.`}
  image={post.data.image}
>
  <article class="px-6 lg:px-40 py-20 max-w-4xl mx-auto">
    <a
      href="/blog"
      class="inline-flex items-center text-primary-400 hover:text-white mb-8 transition-colors"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-5 mr-2"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg>
      Volver al blog
    </a>

    {/* Imagen destacada */}
    {
      post.data.image && (
        <img
          src={post.data.image}
          alt={post.data.title}
          class="w-full rounded-2xl mb-10 object-cover max-h-125"
        />
      )
    }

    <h1 class="text-white text-4xl md:text-5xl font-bold mb-4 leading-tight">
      {post.data.title}
    </h1>

    <p class="text-gray-400 text-sm mb-10 border-b border-white/10 pb-6">
      Publicado el {formatDate(post.data.date)}
    </p>

    {/* Contenido del markdown */}
    <div class="prose prose-lg prose-invert max-w-none text-gray-300">
      <Content />
    </div>
  </article>
</LayoutNav>
